defenv
setenv bootfromnand 0
setenv reboot_mode normal
setenv librefromsd 'if test ${bootfromnand} = 1; then setenv bootfromnand 0; saveenv; exit; fi;if mmcinfo; then if fatload mmc 0 ${loadaddr} kernel.img; then if fatload mmc 0 ${dtb_mem_addr} dtb.img;then wipeisb; bootm ${loadaddr};fi;fi;fi'
setenv librefromnand 'if imgread kernel boot ${loadaddr}; then wipeisb; bootm ${loadaddr}; fi'
setenv bootcmd 'run librefromsd; if test ${libreonnand} = 1; then run librefromnand; else run storeboot; fi'
saveenv
run storeargs
run librefromsd
run recovery_from_flash