From 2f838ecae823478acfae862d8f40b9c75abcdc11 Mon Sep 17 00:00:00 2001
From: kszaq <kszaquitto@gmail.com>
Date: Thu, 6 Apr 2017 00:20:15 +0200
Subject: [PATCH] AMLUtils: fix parsing extended 4K formats, e.g.
 2160p60hz42010bit

---
 xbmc/utils/AMLUtils.cpp | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)

diff --git a/xbmc/utils/AMLUtils.cpp b/xbmc/utils/AMLUtils.cpp
index cd19ec7..cd9c46b 100644
--- a/xbmc/utils/AMLUtils.cpp
+++ b/xbmc/utils/AMLUtils.cpp
@@ -489,7 +489,7 @@ bool aml_mode_to_resolution(const char *mode, RESOLUTION_INFO *res)
     res->fRefreshRate = 59.940;
     res->dwFlags = D3DPRESENTFLAG_INTERLACED;
   }
-  else if (StringUtils::EqualsNoCase(fromMode, "4k2ksmpte") || StringUtils::EqualsNoCase(fromMode, "smpte24hz"))
+  else if (StringUtils::EqualsNoCase(fromMode, "4k2ksmpte") || StringUtils::StartsWith(fromMode, "smpte24hz"))
   {
     res->iWidth = 1920;
     res->iHeight= 1080;
@@ -498,7 +498,7 @@ bool aml_mode_to_resolution(const char *mode, RESOLUTION_INFO *res)
     res->fRefreshRate = 24;
     res->dwFlags = D3DPRESENTFLAG_PROGRESSIVE;
   }
-  else if (StringUtils::EqualsNoCase(fromMode, "4k2k23hz") || StringUtils::EqualsNoCase(fromMode, "2160p23hz"))
+  else if (StringUtils::EqualsNoCase(fromMode, "4k2k23hz") || StringUtils::StartsWith(fromMode, "2160p23hz"))
   {
     res->iWidth = 1920;
     res->iHeight= 1080;
@@ -507,7 +507,7 @@ bool aml_mode_to_resolution(const char *mode, RESOLUTION_INFO *res)
     res->fRefreshRate = 23.976;
     res->dwFlags = D3DPRESENTFLAG_PROGRESSIVE;
   }
-  else if (StringUtils::EqualsNoCase(fromMode, "4k2k24hz") || StringUtils::EqualsNoCase(fromMode, "2160p24hz"))
+  else if (StringUtils::EqualsNoCase(fromMode, "4k2k24hz") || StringUtils::StartsWith(fromMode, "2160p24hz"))
   {
     res->iWidth = 1920;
     res->iHeight= 1080;
@@ -516,7 +516,7 @@ bool aml_mode_to_resolution(const char *mode, RESOLUTION_INFO *res)
     res->fRefreshRate = 24;
     res->dwFlags = D3DPRESENTFLAG_PROGRESSIVE;
   }
-  else if (StringUtils::EqualsNoCase(fromMode, "4k2k25hz") || StringUtils::EqualsNoCase(fromMode, "2160p25hz"))
+  else if (StringUtils::EqualsNoCase(fromMode, "4k2k25hz") || StringUtils::StartsWith(fromMode, "2160p25hz"))
   {
     res->iWidth = 1920;
     res->iHeight= 1080;
@@ -525,7 +525,7 @@ bool aml_mode_to_resolution(const char *mode, RESOLUTION_INFO *res)
     res->fRefreshRate = 25;
     res->dwFlags = D3DPRESENTFLAG_PROGRESSIVE;
   }
-  else if (StringUtils::EqualsNoCase(fromMode, "4k2k29hz") || StringUtils::EqualsNoCase(fromMode, "2160p29hz"))
+  else if (StringUtils::EqualsNoCase(fromMode, "4k2k29hz") || StringUtils::StartsWith(fromMode, "2160p29hz"))
   {
     res->iWidth = 1920;
     res->iHeight= 1080;
@@ -534,7 +534,7 @@ bool aml_mode_to_resolution(const char *mode, RESOLUTION_INFO *res)
     res->fRefreshRate = 29.970;
     res->dwFlags = D3DPRESENTFLAG_PROGRESSIVE;
   }
-  else if (StringUtils::EqualsNoCase(fromMode, "4k2k30hz") || StringUtils::EqualsNoCase(fromMode, "2160p30hz"))
+  else if (StringUtils::EqualsNoCase(fromMode, "4k2k30hz") || StringUtils::StartsWith(fromMode, "2160p30hz"))
   {
     res->iWidth = 1920;
     res->iHeight= 1080;
@@ -543,7 +543,7 @@ bool aml_mode_to_resolution(const char *mode, RESOLUTION_INFO *res)
     res->fRefreshRate = 30;
     res->dwFlags = D3DPRESENTFLAG_PROGRESSIVE;
   }
-  else if (StringUtils::EqualsNoCase(fromMode, "2160p50hz420"))
+  else if (StringUtils::StartsWith(fromMode, "2160p50hz"))
   {
     res->iWidth = 1920;
     res->iHeight= 1080;
@@ -552,7 +552,7 @@ bool aml_mode_to_resolution(const char *mode, RESOLUTION_INFO *res)
     res->fRefreshRate = 50;
     res->dwFlags = D3DPRESENTFLAG_PROGRESSIVE;
   }
-  else if (StringUtils::EqualsNoCase(fromMode, "2160p60hz420"))
+  else if (StringUtils::StartsWith(fromMode, "2160p60hz"))
   {
     res->iWidth = 1920;
     res->iHeight= 1080;
-- 
1.8.3.1

